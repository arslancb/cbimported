<a
	href="{$normal_vid_file}"
	style="display:block;width:{$player_data.width}; height:{$player_data.height}"
	id="the_Video_Player">
    {if !$player_data.autoplay}
    <div align="center" style="background-color:#000; height:100%; vertical-align:middle; position:relative">
    	<img src="{getThumb vdetails=$vdata num=big}" style=" height:100%" />
        <img src="{$pak_player_url}/play.png" style="position:absolute; top:50%; left:50%; margin:-42px 0px 0px -42px; z-index:100"/>
	</div>
    {/if}
</a>


<script language="JavaScript">
var pakplayer_path = '{$pak_player_url}';
var player_logo = '{$player_logo}';
var hq_video_file = '{$hq_vid_file}';
var normal_video_file = '{$normal_vid_file}';
var ytcode = '{$ytcode}';
var pre_item = "";
var next_item = "";
var splash_img = '{getThumb vdetails=$vdata num='big'}';

{literal}
//Now lets write an HQ video function that swaps the original video with hq
var video_quality = 'normal';
function toggleQuality(obj)
{
	if(video_quality=='normal')
	{
		video_quality = 'hq';
		var playerTime = flowplayer(obj).getTime();
		flowplayer(obj).stop();
		flowplayer(obj).getClip(0).update({ url:hq_video_file });
		flowplayer(obj).play();
		if(flowplayer(obj).isPlaying())
		{
			//flowplayer(obj).seek(playerTime);
		}
	}else
	{
		var playerTime = flowplayer(obj).getTime();
		flowplayer(obj).stop();
		flowplayer(obj).getClip(0).update({ url:normal_video_file });
		video_quality = 'normal';
		flowplayer(obj).play();
		if(flowplayer(obj).isPlaying())
		{
			//flowplayer(obj).seek(playerTime);
		}
	}
}

function pakplayer_hq()
{
	toggleQuality('the_Video_Player');
}
has_hq_function = true;
hq_function = pakplayer_hq;

{/literal}
var bufferingStopped = false;
var menu = new Array("menu","embed/share","settings/playlist","comments","donate"); 
flowplayer("the_Video_Player", "{$pak_player_url}/pakplayer{if $Cbucket->configs.pak_license}.unlimited{/if}.swf", 
	{literal}{{/literal}
	{if $Cbucket->configs.pak_license}
	key : '{$Cbucket->configs.pak_license}',	
	{/if}
	{literal}
	plugins: {
		controls: {
			
			{/literal}
			{if $pakconfigs}
				{foreach from=$pakconfigs item=value key=config}
					{$config} : "{$value.default}",
				{/foreach}
			{else}
			background: "url("+pakplayer_path+"/bg.png) repeat",
			url: "pakplayer.controls.swf",
			{/if}
			{literal}
		},
		
		{/literal}
		{if $youtube}
		youtube :
		{literal}
		{
			url:pakplayer_path+'/pakplayer.youtube.swf',
			enableGdata: true,
		}
		{/literal}
		{/if}
		{literal}

	},
	canvas: {
    backgroundGradient: "none",
    backgroundColor: "#000000"
  }
,

	clip:
	{
		{/literal}
		autoPlay :true,
		{if $youtube}
		url : 'api:{$ytcode}',
		provider : 'youtube',
		urlResolvers: 'youtube',
		//scaling : 'scale',
		
		{else}
		url : normal_video_file,
		scaling : 'fit',
		{/if}
		{literal}
		onLastSecond: function()
		{
			if(next_item)
			{
				if($.cookie('auto_play_playlist'))
				window.location = next_item;
			}
		},
	},
	
	logo:
	{
		url: player_logo,
		fullscreenOnly: false,
		{/literal}
		{$logo_position},
		{literal}
		
	},
	

	
});


function htmlDecode(value){ 
  return $('<div/>').html(value).text(); 
}

function updateEmbedCode(width,height,autoplay)
{ 
	if(autoplay=='yes')
		autoPlayVid = 'true';
	else
		autoPlayVid = 'false';
	
	embedPlayerWidth = width;
	embedPlayerHeight = height;
	autoPlayEmbed = autoplay;
		
	$f('the_Video_Player').embed({width:width,height:height}); 
	var embedCode = flowplayer('the_Video_Player').getEmbedCode();
	$('#embed_code').val(htmlDecode(embedCode)); 
	$('#embed_code').val( $('#embed_code').val().replace(/\"autoPlay\":(true|false)/g,'"autoPlay":'+autoPlayVid) );
}

$(document).ready(function(){ 
updateEmbedCode(embedPlayerWidth,embedPlayerHeight,autoPlayEmbed);
});

{/literal}
</script>